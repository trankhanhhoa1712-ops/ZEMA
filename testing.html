 function calculateAverage() {
      const form = document.getElementById('surveyForm');
      let total = 0, count = 0;
      for (let i = 1; i <= 6; i++) {
        const rating = form.querySelector(`input[name="q${i}"]:checked`);
        if (rating) {
          total += parseInt(rating.value);
          count++;
        }
      }
      
      if (count > 0) {
        const avg = (total / count).toFixed(2);
        const name = document.getElementById('name').value || "Khách hàng";
        
        // Hiển thị kết quả
        document.getElementById('result').style.display = 'block';
        document.getElementById('averageScore').textContent = `Điểm: ${avg}`;
        
        // Tính phần trăm hư tổn (điểm 5 = 0% hư tổn, điểm 1 = 100% hư tổn)
        const damagePercent = 100 - ((avg - 1) / 4 * 100);
        
        // Cập nhật đồ thị hư tổn
        document.getElementById('damagePercent').textContent = `${damagePercent.toFixed(0)}%`;
        document.getElementById('damageFill').style.width = `${damagePercent}%`;
        document.getElementById('damageFill').textContent = `${damagePercent.toFixed(0)}%`;
        
        // Đặt màu sắc cho thanh tiến trình dựa trên mức độ hư tổn
        let meterColor;
        if (damagePercent <= 25) {
            meterColor = 'linear-gradient(90deg, #4caf50 0%, #8bc34a 100%)';
        } else if (damagePercent <= 50) {
            meterColor = 'linear-gradient(90deg, #cddc39 0%, #ffeb3b 100%)';
        } else if (damagePercent <= 75) {
            meterColor = 'linear-gradient(90deg, #ffc107 0%, #ff9800 100%)';
        } else {
            meterColor = 'linear-gradient(90deg, #ff5722 0%, #f44336 100%)';
        }
        document.getElementById('damageFill').style.background = meterColor;
        
        // Xác định đánh giá và khuyến nghị
        let evaluation, recommendation, scoreClass, evaluationClass;
        let recommendations = [];
        
        if (avg >= 4.0) {
          evaluation = "Tóc khỏe";
          recommendation = "Có thể thực hiện uốn/duỗi/nhuộm. Chỉ cần chăm dưỡng cơ bản.";
          scoreClass = "score-good";
          evaluationClass = "evaluation-good";
          recommendations = [
            "Dưỡng tóc nhẹ nhàng 1 lần/tuần để duy trì",
            "Che chắn cho tóc khi ra ngoài",
            "Cắt tỉa ngọn định kỳ 3 tháng/lần"
          ];
        } else if (avg >= 3.0) {
          evaluation = "Tóc trung bình";
          recommendation = "Nên phục hồi nhẹ trước & sau dịch vụ hóa chất.";
          scoreClass = "score-medium";
          evaluationClass = "evaluation-medium";
          recommendations = [
            "Phục hồi chuyên sâu tại salon tóc 1-2 lần/tháng",
            "Dầu dưỡng không cần rửa để bảo vệ tóc hằng ngày",
            "Cắt tỉa ngọn 2-3 tháng/lần"
          ];
        } else if (avg >= 2.0) {
          evaluation = "Tóc yếu";
          recommendation = "Hạn chế hóa chất mạnh. Khuyến nghị phục hồi chuyên sâu.";
          scoreClass = "score-weak";
          evaluationClass = "evaluation-weak";
          recommendations = [
            "Phục hồi chuyên sâu tại salon với Protein treatment 2-3 lần/tháng",
            "Sử dụng serum dưỡng tóc chuyên sâu chứa Peptide/Protein",
            "Hạn chế sử dụng nhiệt và hóa chất",
            "Cắt tỉa ngọn mỗi 6-8 tuần"
          ];
        } else {
          evaluation = "Hư tổn nặng";
          recommendation = "Không nên làm hóa chất. Tập trung phục hồi, cắt tỉa.";
          scoreClass = "score-critical";
          evaluationClass = "evaluation-critical";
          recommendations = [
            "Phục hồi chuyên sâu tại salon 1-2 lần/tuần",
            "Sử dụng liệu pháp bond building để tái tạo cấu trúc tóc",
            "Cắt bỏ phần tóc hư tổn không thể phục hồi",
            "Tránh hoàn toàn việc nhuộm, uốn, duỗi trong ít nhất 3 tháng",
            "Bảo vệ tóc khi ra nắng"
          ];
        }
        
        // Cập nhật giao diện
        const evaluationElement = document.getElementById('evaluation');
        evaluationElement.textContent = `Đánh giá: ${evaluation}`;
        evaluationElement.className = 'evaluation ' + evaluationClass;
        
        document.getElementById('recommendationText').textContent = recommendation;
        
        // Hiển thị danh sách đề xuất
        const recommendationList = document.getElementById('recommendationList');
        recommendationList.innerHTML = '';
        recommendations.forEach(rec => {
            const li = document.createElement('li');
            li.textContent = rec;
            recommendationList.appendChild(li);
        });
        
        // Đặt màu cho điểm số
        const averageScore = document.getElementById('averageScore');
        averageScore.className = 'average-score ' + scoreClass;
        
        // Cuộn đến kết quả
        document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        
      } else {
        alert("Vui lòng chấm điểm tất cả tiêu chí.");
      }
    }
</script>
</body>
</html>"
